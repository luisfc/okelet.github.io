<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Mis notas</title><link href="https://okelet.github.io/" rel="alternate"></link><link href="https://okelet.github.io/feeds/category/openstack.atom.xml" rel="self"></link><id>https://okelet.github.io/</id><updated>2016-02-18T00:00:00+01:00</updated><entry><title>Instalar OpenStack PackStack detrás de un proxy</title><link href="https://okelet.github.io/posts/2016/02/instalar-openstack-packstack-detras-de-un-proxy/" rel="alternate"></link><updated>2016-02-18T00:00:00+01:00</updated><author><name>Juan Asensio Sánchez</name></author><id>tag:okelet.github.io,2016-02-18:posts/2016/02/instalar-openstack-packstack-detras-de-un-proxy/</id><summary type="html">&lt;p&gt;Trasteando con Openstack, con ganas desde hace tiempo, y después de la &lt;a href="http://www.meetup.com/es-ES/MAD-for-OpenStack/events/227554166/"&gt;Mini-Conf&lt;/a&gt; del grupo &lt;a href="http://www.meetup.com/es-ES/MAD-for-OpenStack/"&gt;MAD for OpenStack&lt;/a&gt;, me animé a probarlo usando &lt;a href="https://wiki.openstack.org/wiki/Packstack"&gt;PackStack&lt;/a&gt;, que te lo configura todo en una única máquina (no tengo claro si se puede considerar una instalación productiva o sólo para pruebas), aunque luego puedes ir añadiendo nodos adicionales. Dado que no tengo acceso a ningún host físico, instalé un RH 7.2 (también vale &lt;a href="https://getfedora.org"&gt;Fedora&lt;/a&gt; o &lt;a href="https://www.centos.org"&gt;CentOS&lt;/a&gt;) en una máquina virtual de VMware (el rendimiento dependerá en gran medida si se tiene habilitado o no la &lt;em&gt;&lt;a href="http://www.josemariagonzalez.es/2012/10/01/como-virtualizar-un-vmware-esxi-en-modo-nested.html"&gt;nested virtualization&lt;/a&gt;&lt;/em&gt;). Empecé con una máquina con 2 procesadores y 2 GB de RAM, pero enseguida me di cuenta que se quedaba muy corta, incluso sin ninguna instancia arrancada. La versión final tiene 8 procesadores y 8 GB de RAM.&lt;/p&gt;


&lt;p&gt;El siguiente problema que me surgió es que me daba un error al instalar el paquete de Cinder, ya que le faltaba una dependencia. Y no me lo explicaba, porque esa dependencia está en el repositorio de EPEL, que lo tenía configurado y habilitado. Después de varias pruebas, me di cuenta que el instalador deshabilita ese repositorio, y hay que forzar a que lo utilice con un parámetro adicional (&lt;code&gt;--use-epel=y&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Después, me daba fallo al descargar la imagen de &lt;a href="https://launchpad.net/cirros"&gt;CirrOS&lt;/a&gt; para ponerla como disponible para nuevas instancias, y es que esta imagen se la descarga de Internet, así que tenía que utilizar el proxy, por lo que me creé un &lt;code&gt;/etc/profile.d/proxy.sh&lt;/code&gt; donde se establecía, pero el proxy hacía que fallaran las peticiones REST que se realizan durante la instalación para registrar componentes, configuración, etc. Así que encontré una opción que lo que hace es utilizar una imagen descargada localmente, en lugar de descargársela de Internet. Por tanto, borré el profile.d del proxy, y me bajé la imagen a mano:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;https_proxy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;http://mi.proxy:8080
wget --no-check-certificate https://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Una vez hecho esto, hay que tener configurado el proxy en Yum, ya que se descarga bastantes paquetes de Internet. Una vez hechas todas estas comprobaciones, se puede lanzar la instalación de PackStack:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;packstack --use-epel&lt;span class="o"&gt;=&lt;/span&gt;y --provision-image-url&lt;span class="o"&gt;=&lt;/span&gt;/root/cirros-0.3.4-x86_64-disk.img --allinone
&lt;/pre&gt;&lt;/div&gt;</summary></entry></feed>